<main>

  <app-content-header
    title="NFe"
    btn_label="Novo"
    fontIcon="add"
    (onClick)="handleOpenForm()"
  >
    <button mat-flat-button>
      <span matListItemTitle>Consultar</span>
    </button>
    <button mat-flat-button>
      <span matListItemTitle>Enviar</span>
    </button>
</app-content-header>

  @if (nfePaginatedList?.totalElements) {
    <app-generic-table
      [columns]="columns"
      [genericPaginatedList]="nfePaginatedList"
      [totalElements]="nfePaginatedList!.totalElements"
      [pageSizeOptions]="[5, 10, 25, 100]"
      (rowClick)="onRowClick($event)"
      (pageEvent)="handlePageEvent($event)"
      (editClick)="handleEdit($event)"
      (selectionChange)="handleSelectionChange($event)"
    />
  } @else {
    @if (nfeListLoading()) {
      <div class="loader-div">
        <span class="loader"></span>
      </div>
    }
    @else {
      @if (nfeListError()) {
        <div class="message-error mat-elevation-z8">
          <h3>Não foi possível acessar os dados da tabela</h3>
          <h4>Tente novamente em alguns minutos.</h4>
        </div>
      }
      @else {
        <br />
        <h2>Não há NFes cadastradas</h2>
      }
    }
  }

  @if (openInfo()) {
    <app-drawer (closeDrawer)="handleCloseDrawer()">
      @if (selectedNfe) {
        <mat-tab-group [selectedIndex]="0">
          <mat-tab label="Nfe">
            NFE info
          </mat-tab>
        </mat-tab-group>
      } @else {
        <h1>Dados não encontrados</h1>
      }
    </app-drawer>
  } @if (openForm()) {
    <app-drawer (closeDrawer)="handleConfirmationCloseDrawer()">
      <mat-tab-group>
        <mat-tab
          label="NFe Entrada"
        >
          <app-nfe-entrada-form />
        </mat-tab>
              <mat-tab
          label="NFe Saída"
        >
          <app-nfe-saida-form />
        </mat-tab>
      </mat-tab-group>
    </app-drawer>
  }
</main>
