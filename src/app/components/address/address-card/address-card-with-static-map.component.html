<div class="address-card" [class.inactive]="!address.active">
  <!-- Header -->
  <div class="card-header">
    <div class="type-badge">
      <mat-icon class="type-icon">{{ typeIcon }}</mat-icon>
      <span class="type-label">{{ typeLabel }}</span>
    </div>

    <div class="badges">
      @if (address.mainAddress) {
        <span class="badge main">
          <mat-icon>star</mat-icon>
          Principal
        </span>
      }
      @if (!address.active) {
        <span class="badge inactive">
          Inativo
        </span>
      }
    </div>
  </div>

  <!-- Address Info -->
  <div class="card-body">
    <div class="address-line">
      <mat-icon class="info-icon">location_on</mat-icon>
      <span>{{ fullAddress }}</span>
    </div>

    <div class="address-line">
      <mat-icon class="info-icon">apartment</mat-icon>
      <span>{{ address.neighborhood }}</span>
    </div>

    <div class="address-line">
      <mat-icon class="info-icon">place</mat-icon>
      <span>{{ cityState }}</span>
    </div>

    <div class="address-line">
      <mat-icon class="info-icon">mail</mat-icon>
      <span>CEP: {{ formattedCep }}</span>
    </div>
  </div>

  <!-- OPÇÃO 1: Mapa Estático (imagem) -->
  @if (showMap) {
    <div class="map-container">
      <img [src]="staticMapUrl" 
           alt="Mapa do endereço" 
           class="static-map"
           (click)="openInGoogleMaps()"
           matTooltip="Clique para abrir no Google Maps">
      <button mat-icon-button 
              class="close-map-btn"
              (click)="toggleMap()"
              matTooltip="Fechar mapa">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  }

  <!-- Botões de Mapa -->
  <div class="map-actions">
    <button mat-stroked-button
      color="primary"
      (click)="toggleMap()"
      class="btn-map">
      <mat-icon>{{ showMap ? 'visibility_off' : 'map' }}</mat-icon>
      {{ showMap ? 'Ocultar Mapa' : 'Ver Mapa' }}
    </button>

    <button mat-stroked-button
      (click)="openInGoogleMaps()"
      class="btn-map-external">
      <mat-icon>open_in_new</mat-icon>
      Abrir no Maps
    </button>
  </div>

  <!-- Actions -->
  <div class="card-actions">
    @if (canEdit) {
      <button mat-icon-button
        (click)="onEdit()"
        matTooltip="Editar endereço"
        class="action-btn edit">
        <mat-icon>edit</mat-icon>
      </button>
    }

    @if (canDelete) {
      <button mat-icon-button
        (click)="onDelete()"
        matTooltip="Excluir endereço"
        class="action-btn delete">
        <mat-icon>delete</mat-icon>
      </button>
    }

    @if (canSetMain && !address.mainAddress) {
      <button mat-icon-button
        (click)="onSetMain()"
        matTooltip="Definir como principal"
        class="action-btn star">
        <mat-icon>star_outline</mat-icon>
      </button>
    }
  </div>
</div>
